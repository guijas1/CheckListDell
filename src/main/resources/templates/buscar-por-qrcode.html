<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Buscar por QRCode</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-5">

<h3>üì∑ Escanear QRCode do Arm√°rio</h3>

<div id="reader" style="width:300px"></div>
<div id="result" class="mt-3"></div>

<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
<script>
    function onScanSuccess(decodedText, decodedResult) {
        // decodedText ser√° o conte√∫do do QRCode (ex: "Armario 22")
        console.log(`C√≥digo lido: ${decodedText}`);

        // redireciona para a rota do seu controller
        window.location.href = "/checklists/localizacao/" + encodeURIComponent(decodedText);
    }

    function onScanFailure(error) {
        // erros podem ser ignorados normalmente (tentativas falhas de leitura)
        console.warn(`Erro na leitura: ${error}`);
    }

    let html5QrcodeScanner = new Html5QrcodeScanner(
        "reader", { fps: 10, qrbox: 250 });
    html5QrcodeScanner.render(onScanSuccess, onScanFailure);
</script>

</body>
</html>